@{ 
    ViewBag.titulo = "Cadastrar Solicitação";
}
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h2>  <small>  </small></h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li>
                        <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                            <li>
                                <a href="#">Settings 1</a>
                            </li>
                            <li>
                                <a href="#">Settings 2</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <br />
                <form id="" data-parsley-validate class="form-horizontal form-label-left" action="@Url.Action("CadastrarSolicitacao","Solicitacao")" method="post">


                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="setor">
                            Setor <span class="required">*</span>
                        </label>
                        <div class="col-md-4 col-sm-4 col-xs-4">
                            <select class="form-control" name="setor" id="setor" required>
                                <option value="" selected>SELECIONE</option>
                                <option value="MECANICA">MECANICA</option>
                                <option value="AUTOMACAO">AUTOMACAO</option>
                                <option value="ELETRICA">ELETRICA</option>
                                <option value="CIVIL">CIVIL</option>
                                <option value="SEGURANÇA">SEGURANÇA</option>
                                <option value="COMPRAS">COMPRAS</option>
                                <option value="PROJETOS">PROJETOS</option>
                                <option value="CIPA">CIPA</option>
                                <option value="TI">TI</option>
                                <option value="JARDINAGEM">JARDINAGEM</option>
                                <option value="PINTURA">PINTURA</option>
                                <option value="RH">RH</option>
                                <option value="CONTABILIDADE">CONTABILIDADE</option>
                                <option value="LIMPEZA">LIMPEZA</option>
                                <option value="BALANÇA">BALANÇA</option>
                                <option value="ESCRITÓRIO">ESCRITÓRIO</option>
                                <option value="FATURAMENTO">FATURAMENTO</option>
                            </select>
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="prioridade">
                            Prioridade <span class="required">*</span>
                        </label>
                        <div class="col-md-4 col-sm-4 col-xs-4">
                            <select class="form-control" name="prioridade" id="prioridade" required>
                                <option value="" selected>SELECIONE</option>
                                <option value="SIMPLES">SIMPLES</option>
                                <option value="PROGRAMACAO">PROGRAMACAO</option>
                                <option value="MODERADA">MODERADA</option>
                                <option value="URGENTE">URGENTE</option>
                                <option value="EMERGÊNCIA">EMERGÊNCIA</option>
                                <option value="MODIFICAÇÃO">MODIFICAÇÃO</option>
                                <option value="MELHORIA">MELHORIA</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="modalidade">
                            Modalidade <span class="required">*</span>
                        </label>
                        <div class="col-md-4 col-sm-4 col-xs-4">
                            <select class="form-control" name="modalidade" id="modalidade" required>
                                <option value="" selected>SELECIONE</option>
                                <option value="CORRETIVA">CORRETIVA</option>
                                <option value="PREVENTIVA">PREVENTIVA</option>
                                <option value="PREDITIVA">PREDITIVA</option>
                                <option value="SERVIÇOS_GERAIS">SERVIÇOS GERAIS</option>
                                <option value="PLANO_DE_INSPEÇÃO">PLANO DE INSPEÇÃO</option>
                            </select>
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="area">
                            Área <span class="required">*</span>
                        </label>
                        <div class="col-md-4 col-sm-4 col-xs-4">
                            <select class="form-control" name="area" id="area" required>

                                <option value="" selected>SELECIONE</option>
                                @{

                                    foreach (var area in ViewBag.area)
                                    {
                                        <option value="@area.Id">@area.codigo - @area.nome </option>
                                    }
                                }

                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="equipamento">
                            Equipamento <span class="required">*</span>
                        </label>
                        <img src='~/Template/build/gif/loading.gif' id='loader' style="width: 18%;margin-right: -5%;margin-top: -14%;display:none" />
                        <div class="col-md-4 col-sm-4 col-xs-4">

                            <select class="form-control" name="equipamento" id="equipamento" disabled required>
                                <option value="" selected>SELECIONE</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-3 col-sm-3 col-xs-12">Descrição</label>
                        <div class="col-md-4 col-sm-4 col-xs-4">
                            <textarea id="descricao" name="descricao" class="resizable_textarea form-control" placeholder="Descrição..." required></textarea>
                        </div>
                    </div>
                    <div class="ln_solid"></div>
                    <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                            <button class="btn btn-primary" type="reset">Reset</button>
                            <button type="submit" class="btn btn-success">Cadastrar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
    

            $("#area").change(function () {

                if ($(this).val() != "") {
                    $("#loader").css({ display: "block" });
                    $("#loader").css({ width: "18%" });
                    var url = "@Url.Action("CadastrarSolicitacao", "Solicitacao")" + "?id=" + $(this).val();
                    

                    $.get(url, null, function (data) {
                        $("#equipamento").empty();
                        $(data).each(function (i) {
                            $("#equipamento").append("<option value='" + data[i].id + "'>" + data[i].nome + "</option>");
                        });

                        if ($('#equipamento').children('option').length > 0) {
                            $("#equipamento").prop("disabled", false);
                            $("#loader").css({ display: "none" });
                        } else {
                            var valor = "";
                            var option = "SELECIONE"
                            $("#equipamento").prop("disabled", true);
                            $("#equipamento").append("<option value='" + valor + "'>" + option + "</option>");
                            $("#loader").css({ display: "none" });
                            $("#loader").css({ width: "18%" });
                        }
                    });
                } else {
                        $("#equipamento").empty();
                        $("#loader").css({ width: "18%" });
                    var valor = "";
                    var option = "SELECIONE"
                    $("#equipamento").prop("disabled", true);
                    $("#equipamento").append("<option value='" + valor + "'>" + option + "</option>");

                }
            });
        });



    </script>
